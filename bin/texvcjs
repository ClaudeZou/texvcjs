#!/usr/bin/env node

var program = require('commander');
var util = require('util');

var json = require('../package.json');

program
    .version(json.version)
    .usage('[options] <tex input>')
    .option('--rebuild', 'Rebuild PEGjs grammar before parsing')
    .option('-v, --verbose', 'Show verbose error information');

program.parse(process.argv);

var input = program.args.join(' ');

if (program.rebuild) {
    require('../lib/build-parser');
}

var texvcjs = require('../');
var result = texvcjs.check(input);
if (result.status === '+') {
    util.print(result.status + (result.output || ''));
} else if (result.status === 'F' || program.verbose) {
    util.print(result.status + (result.details || ''));
} else {
    util.print(result.status);
}
process.exit(result.status);
