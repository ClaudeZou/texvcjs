#!/usr/bin/env node

var program = require('commander');
var json = require('../package.json');

program
	.version(json.version)
	.usage('[options] <tex input>')
    .option('--rebuild', 'Rebuild PEGjs grammar before parsing')
    .option('-v, --verbose', 'Show verbose error information');

program.parse(process.argv);

var input = program.args.join(' ');

if (program.rebuild) {
	require('../lib/build-parser');
}

var texvcjs = require('../');
var result = texvcjs.check(input);
if (result.status === '+') {
	console.log(result.status + (result.output || ''));
} else if (result.status === 'F' || program.verbose) {
	console.log(result.status + (result.details || ''));
} else {
	console.log(result.status);
}
process.exit(result.status);
